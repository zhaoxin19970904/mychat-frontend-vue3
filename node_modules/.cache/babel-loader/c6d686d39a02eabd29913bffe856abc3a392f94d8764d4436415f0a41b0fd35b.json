{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { reactive, onMounted, ref } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport axios from 'axios';\nimport { jwtDecode } from 'jwt-decode';\nexport default {\n  __name: 'EditUser',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const open = ref(false);\n    let dataSource = ref(null);\n    let role = ref('');\n    let message = ref('');\n    const token = localStorage.getItem('token');\n    const decoded = jwtDecode(token);\n    role.value = decoded.role;\n    const router = useRouter();\n    const route = useRoute();\n    const formState = reactive({\n      username: '',\n      password: '',\n      type: 'admin',\n      gender: 'male',\n      age: 0,\n      email: '',\n      birth: new Date()\n    });\n    onMounted(async () => {\n      const userId = route.params.id;\n      if (userId) {\n        try {\n          const response = await axios.get(`http://localhost:8000/users/students/${userId}`);\n          const userData = response.data;\n          formState.username = userData.username;\n          formState.password = userData.password;\n          formState.type = userData.type;\n          formState.gender = userData.gender;\n          formState.age = userData.age;\n          formState.email = userData.email;\n          formState.birth = userData.birth;\n          const chatResponse = await axios.get(`http://localhost:8000/getchat/${userId}`);\n          dataSource.value = chatResponse.data.chats;\n        } catch (error) {\n          console.error('Failed to fetch user data:', error);\n        }\n      }\n    });\n    const onFinish = async () => {\n      console.log('Success:', formState);\n      try {\n        const userId = route.params.id;\n        await axios.post(`http://localhost:8000/users/update/${userId}`, formState);\n        router.push('/adminpage/adminlist');\n      } catch (error) {\n        console.error('Error submitting form', error.response || error);\n        alert('Add failed');\n      }\n    };\n    const onFinishFailed = errorInfo => {\n      console.log('Failed:', errorInfo);\n    };\n    const cancel = () => {\n      router.push('/');\n    };\n    const labelCol = {\n      style: {\n        width: '150px'\n      }\n    };\n    const wrapperCol = {\n      span: 14\n    };\n    const chat = () => {\n      router.push('/chat');\n    };\n    const columns = [{\n      title: 'Name',\n      dataIndex: 'name',\n      width: '8%'\n    }, {\n      title: 'Id',\n      dataIndex: 'id',\n      width: '8%'\n    }, {\n      title: 'Created_At',\n      dataIndex: 'created_at',\n      width: '8%'\n    }, {\n      title: 'Show',\n      dataIndex: 'show',\n      width: '10%'\n    }, {\n      title: 'Remove',\n      dataIndex: 'remove',\n      width: '10%'\n    }];\n    const edit = async id => {\n      // open.value = true;\n\n      const chatmessage = await axios.get(`http://localhost:8000/chatdetails/${id}`);\n      console.log(chatmessage);\n    };\n    const handleOk = () => {\n      open.value = false;\n    };\n    const __returned__ = {\n      open,\n      get dataSource() {\n        return dataSource;\n      },\n      set dataSource(v) {\n        dataSource = v;\n      },\n      get role() {\n        return role;\n      },\n      set role(v) {\n        role = v;\n      },\n      get message() {\n        return message;\n      },\n      set message(v) {\n        message = v;\n      },\n      token,\n      decoded,\n      router,\n      route,\n      formState,\n      onFinish,\n      onFinishFailed,\n      cancel,\n      labelCol,\n      wrapperCol,\n      chat,\n      columns,\n      edit,\n      handleOk,\n      reactive,\n      onMounted,\n      ref,\n      get useRoute() {\n        return useRoute;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      get axios() {\n        return axios;\n      },\n      get jwtDecode() {\n        return jwtDecode;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["reactive","onMounted","ref","useRoute","useRouter","axios","jwtDecode","open","dataSource","role","message","token","localStorage","getItem","decoded","value","router","route","formState","username","password","type","gender","age","email","birth","Date","userId","params","id","response","get","userData","data","chatResponse","chats","error","console","onFinish","log","post","push","alert","onFinishFailed","errorInfo","cancel","labelCol","style","width","wrapperCol","span","chat","columns","title","dataIndex","edit","chatmessage","handleOk"],"sources":["C:/Users/bobxi/OneDrive/Desktop/Ecloud/tut8/my-vue-app/src/components/EditUser.vue"],"sourcesContent":["<template>\r\n    <a-form \r\n    :model=\"formState\" \r\n    :label-col=\"labelCol\" \r\n    :wrapper-col=\"wrapperCol\"\r\n    @finish=\"onFinish\"\r\n    @finishFailed=\"onFinishFailed\"\r\n    >\r\n        <a-form-item\r\n      label=\"Username\"\r\n      name=\"username\"\r\n      :rules=\"[{ required: true, message: 'Please input your username!' }]\"\r\n    >\r\n      <a-input v-model:value=\"formState.username\" />\r\n    </a-form-item>\r\n\r\n        \r\n        <a-form-item\r\n      label=\"Email\"\r\n      name=\"email\"\r\n      :rules=\"[{ required: true, message: 'Please input your email!' }]\"\r\n    >\r\n      <a-input v-model:value=\"formState.email\" />\r\n    </a-form-item>\r\n\r\n      <a-form-item label=\"Gender\">\r\n        <a-radio-group v-model:value=\"formState.gender\">\r\n          <a-radio value=\"male\">Male</a-radio>\r\n          <a-radio value=\"female\">Female</a-radio>\r\n        </a-radio-group>\r\n      </a-form-item>\r\n\r\n      <a-form-item name=\"birth\" label=\"DatePicker\" v-bind=\"config\">\r\n      <a-date-picker v-model:value=\"formState.birth\" value-format=\"YYYY-MM-DD\" />\r\n    </a-form-item>\r\n\r\n    <a-form-item has-feedback label=\"Age\" name=\"age\">\r\n      <a-input-number v-model:value=\"formState.age\" />\r\n    </a-form-item>\r\n\r\n\r\n      <a-form-item :wrapper-col=\"{ span: 14, offset: 4 }\">\r\n        <a-button type=\"primary\" html-type=\"submit\">Update New Information</a-button>\r\n        <a-button  @click=\"cancel\">Cancel</a-button>\r\n      </a-form-item>\r\n    </a-form>\r\n    <div v-if=\"role==='client'\">\r\n    <a-button @click=\"chat\">Add Chat</a-button>\r\n    </div>\r\n    <div>\r\n    <a-modal v-model:open=\"open\" title='Chat' @ok=\"handleOk\">\r\n       <h1>{{id}}</h1>\r\n      <p>{{message}}</p>\r\n    </a-modal>\r\n  </div>\r\n\r\n    <a-table :columns=\"columns\" \r\n    :data-source=\"dataSource\" \r\n    :pagination=\"pagination\"\r\n    @change=\"handleTableChange\"\r\n\r\n    bordered>\r\n    <template #bodyCell=\"{ record, column }\">\r\n        <div v-if=\"column.dataIndex === 'show'\">\r\n      <a-button type=\"primary\" @click=\"edit(record.id)\">Show</a-button>\r\n    </div>\r\n    <div v-else-if=\"column.dataIndex === 'remove'\">\r\n      <a-button \r\n      type=\"primary\" \r\n      @click=\"deleteRecord(record.id)\" \r\n      style=\"background-color: #f5222d; \r\n      color: white;\">Remove</a-button>\r\n    </div>\r\n    <div v-else>\r\n      {{ record[column.dataIndex] }}\r\n    </div>\r\n    </template>\r\n  </a-table>\r\n\r\n  </template>\r\n  <script setup>\r\nimport { reactive, onMounted,ref } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport axios from 'axios';\r\nimport { jwtDecode } from 'jwt-decode';\r\nconst open = ref(false);\r\nlet dataSource = ref(null)\r\nlet role = ref('')\r\nlet message = ref('');\r\nconst token = localStorage.getItem('token');\r\nconst decoded = jwtDecode(token);\r\nrole.value = decoded.role;\r\nconst router = useRouter();\r\nconst route = useRoute();\r\n  const formState = reactive({\r\n    username: '',\r\n    password: '',\r\n    type: 'admin',\r\n    gender: 'male',\r\n    age: 0,\r\n    email: '',\r\n    birth: new Date()\r\n});\r\n\r\nonMounted(async () => {\r\n  const userId = route.params.id; \r\n  if (userId) {\r\n    try {\r\n      const response = await axios.get(`http://localhost:8000/users/students/${userId}`);\r\n      const userData = response.data;\r\n      formState.username = userData.username;\r\n      formState.password = userData.password; \r\n      formState.type = userData.type;\r\n      formState.gender = userData.gender;\r\n      formState.age = userData.age;\r\n      formState.email = userData.email;\r\n      formState.birth = userData.birth; \r\n\r\n      const chatResponse = await axios.get(`http://localhost:8000/getchat/${userId}`);\r\n\r\n      dataSource.value = chatResponse.data.chats;\r\n    \r\n    } catch (error) {\r\n      console.error('Failed to fetch user data:', error);\r\n  \r\n    }\r\n  }\r\n\r\n});\r\n\r\nconst onFinish = async () => {\r\n  console.log('Success:', formState);\r\n\r\ntry {\r\n    const userId = route.params.id; \r\n  await axios.post(`http://localhost:8000/users/update/${userId}`, formState);\r\n  router.push('/adminpage/adminlist');\r\n} catch (error) {\r\n  console.error('Error submitting form', error.response || error);\r\n  alert('Add failed');\r\n\r\n}\r\n}\r\nconst onFinishFailed = errorInfo => {\r\n  console.log('Failed:', errorInfo);\r\n};\r\nconst cancel = () => {\r\n  router.push('/');\r\n};\r\n  const labelCol = {\r\n    style: {\r\n      width: '150px',\r\n    },\r\n  };\r\n  const wrapperCol = {\r\n    span: 14,\r\n  };\r\n\r\n  const chat = () =>{\r\n    router.push('/chat')\r\n  }\r\n\r\n  const columns = [\r\n    {\r\n      title: 'Name',\r\n      dataIndex: 'name',\r\n      width: '8%',\r\n    },\r\n    {\r\n      title: 'Id',\r\n      dataIndex: 'id',\r\n      width: '8%',\r\n    },\r\n    {\r\n      title: 'Created_At',\r\n      dataIndex: 'created_at',\r\n      width: '8%',\r\n    },\r\n\r\n    {\r\n      title: 'Show',\r\n      dataIndex: 'show',\r\n      width: '10%',\r\n\r\n    },\r\n    {\r\n      title: 'Remove',\r\n      dataIndex: 'remove',\r\n      width: '10%',\r\n    },\r\n  ];\r\n  const edit= async (id)=>{\r\n    // open.value = true;\r\n\r\n    const chatmessage = await axios.get(`http://localhost:8000/chatdetails/${id}`)\r\n    console.log(chatmessage)\r\n\r\n  }\r\n  const handleOk = () => {\r\n  open.value = false;\r\n};\r\n  </script>\r\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}