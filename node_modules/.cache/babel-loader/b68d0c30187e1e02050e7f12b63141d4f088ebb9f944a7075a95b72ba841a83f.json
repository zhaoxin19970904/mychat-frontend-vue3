{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { reactive } from 'vue';\nimport axios from 'axios';\nimport { useRouter } from 'vue-router';\nexport default {\n  __name: 'loginForm',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const formState = reactive({\n      username: '',\n      password: '',\n      remember: true\n    });\n    const onFinish = values => {\n      console.log('Success:', values);\n      axios.post('http://localhost:8000/submit', values).then(response => {\n        const {\n          token,\n          userType\n        } = response.data;\n        localStorage.setItem('token', token);\n\n        // 可选：设置 token 过期时间\n        const expiresAt = new Date(new Date().getTime() + 5 * 60 * 60 * 1000);\n        localStorage.setItem('tokenExpiresAt', expiresAt.toISOString());\n\n        // 根据 userType 决定重定向目标\n        if (userType === 'admin') {\n          router.push('/adminpage');\n        }\n      }).catch(error => {\n        console.log('Error submitting form', error.response);\n      });\n    };\n    const onFinishFailed = errorInfo => {\n      console.log('Failed:', errorInfo);\n    };\n    const __returned__ = {\n      router,\n      formState,\n      onFinish,\n      onFinishFailed,\n      reactive,\n      get axios() {\n        return axios;\n      },\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["reactive","axios","useRouter","router","formState","username","password","remember","onFinish","values","console","log","post","then","response","token","userType","data","localStorage","setItem","expiresAt","Date","getTime","toISOString","push","catch","error","onFinishFailed","errorInfo"],"sources":["C:/Users/bobxi/OneDrive/Desktop/Ecloud/tut8/my-vue-app/src/components/loginForm.vue"],"sourcesContent":["<template>\r\n  <h1>Welcome Chat</h1>\r\n  <a-form\r\n    :model=\"formState\"\r\n    name=\"basic\"\r\n    :label-col=\"{ span: 8 }\"\r\n    :wrapper-col=\"{ span: 16 }\"\r\n    autocomplete=\"off\"\r\n    @finish=\"onFinish\"\r\n    @finishFailed=\"onFinishFailed\"\r\n  >\r\n    <a-form-item\r\n      label=\"Username\"\r\n      name=\"username\"\r\n      :rules=\"[{ required: true, message: 'Please input your username!' }]\"\r\n    >\r\n      <a-input v-model:value=\"formState.username\" />\r\n    </a-form-item>\r\n\r\n    <a-form-item\r\n      label=\"Password\"\r\n      name=\"password\"\r\n      :rules=\"[{ required: true, message: 'Please input your password!' }]\"\r\n    >\r\n      <a-input-password v-model:value=\"formState.password\" />\r\n    </a-form-item>\r\n\r\n    <a-form-item name=\"remember\" :wrapper-col=\"{ offset: 8, span: 16 }\">\r\n      <a-checkbox v-model:checked=\"formState.remember\">Remember me</a-checkbox>\r\n    </a-form-item>\r\n\r\n    <a-form-item :wrapper-col=\"{ offset: 8, span: 16 }\">\r\n      <a-button type=\"primary\" html-type=\"submit\">Submit</a-button>\r\n    </a-form-item>\r\n  </a-form>\r\n</template>\r\n<script setup>\r\nimport { reactive } from 'vue';\r\nimport axios from 'axios';\r\nimport { useRouter } from 'vue-router';\r\nconst router = useRouter();\r\nconst formState = reactive({\r\n  username: '',\r\n  password: '',\r\n  remember: true,\r\n});\r\nconst onFinish = values => {\r\n  console.log('Success:', values);\r\n  axios.post('http://localhost:8000/submit', values)\r\n    .then(response => {\r\n      const { token, userType } = response.data;\r\n      localStorage.setItem('token', token);\r\n\r\n      // 可选：设置 token 过期时间\r\n      const expiresAt = new Date(new Date().getTime() + 5 * 60 * 60 * 1000);\r\n      localStorage.setItem('tokenExpiresAt', expiresAt.toISOString());\r\n\r\n      // 根据 userType 决定重定向目标\r\n      if (userType === 'admin') {\r\n        router.push('/adminpage');\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.log('Error submitting form', error.response);\r\n    });\r\n};\r\nconst onFinishFailed = errorInfo => {\r\n  console.log('Failed:', errorInfo);\r\n};\r\n</script>\r\n  "],"mappings":";AAqCA,SAASA,QAAQ,QAAQ,KAAK;AAC9B,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,SAAS,QAAQ,YAAY;;;;;;;IACtC,MAAMC,MAAM,GAAGD,SAAS,CAAC,CAAC;IAC1B,MAAME,SAAS,GAAGJ,QAAQ,CAAC;MACzBK,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE;IACZ,CAAC,CAAC;IACF,MAAMC,QAAQ,GAAGC,MAAM,IAAI;MACzBC,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEF,MAAM,CAAC;MAC/BR,KAAK,CAACW,IAAI,CAAC,8BAA8B,EAAEH,MAAM,CAAC,CAC/CI,IAAI,CAACC,QAAQ,IAAI;QAChB,MAAM;UAAEC,KAAK;UAAEC;QAAS,CAAC,GAAGF,QAAQ,CAACG,IAAI;QACzCC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEJ,KAAK,CAAC;;QAEpC;QACA,MAAMK,SAAS,GAAG,IAAIC,IAAI,CAAC,IAAIA,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC;QACrEJ,YAAY,CAACC,OAAO,CAAC,gBAAgB,EAAEC,SAAS,CAACG,WAAW,CAAC,CAAC,CAAC;;QAE/D;QACA,IAAIP,QAAQ,KAAK,OAAO,EAAE;UACxBb,MAAM,CAACqB,IAAI,CAAC,YAAY,CAAC;QAC3B;MACF,CAAC,CAAC,CACDC,KAAK,CAACC,KAAK,IAAI;QACdhB,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEe,KAAK,CAACZ,QAAQ,CAAC;MACtD,CAAC,CAAC;IACN,CAAC;IACD,MAAMa,cAAc,GAAGC,SAAS,IAAI;MAClClB,OAAO,CAACC,GAAG,CAAC,SAAS,EAAEiB,SAAS,CAAC;IACnC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}