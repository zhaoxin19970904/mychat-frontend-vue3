{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { onMounted, ref } from 'vue';\nimport { useRouter } from 'vue-router';\nexport default {\n  __name: 'AdminList',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const dataSource = ref([]);\n    const pagination = ref({\n      currentPage: 1,\n      pageSize: 2,\n      totalItems: 0,\n      totalPages: 0\n    });\n    const fetchData = async () => {\n      try {\n        const pageSize = pagination.value.pageSize;\n        const currentPage = pagination.value.currentPage;\n        const response = await fetch(`http://localhost:8000/admins?page=${currentPage}&pageSize=${pageSize}`);\n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const data = await response.json();\n        dataSource.value = data.students; // 假设后端返回的数据字段为 students\n        // 更新分页信息\n        pagination.value.totalPages = data.totalPages;\n        pagination.value.totalItems = data.totalItems;\n      } catch (error) {\n        console.error(\"Fetching error:\", error);\n      }\n    };\n    onMounted(() => {\n      fetchData();\n    });\n    const edit = key => {\n      router.push(`/edit/${key}`);\n    };\n    const deleteRecord = async key => {\n      try {\n        await fetch(`http://localhost:3001/delete/${key}`, {\n          method: 'DELETE'\n        });\n        console.log('Record deleted successfully');\n      } catch (error) {\n        console.error('Failed to delete the record:', error);\n      }\n    };\n    const columns = [{\n      title: 'Name',\n      dataIndex: 'name',\n      width: '8%'\n    }, {\n      title: 'Age',\n      dataIndex: 'age',\n      width: '5%'\n    }, {\n      title: 'Gender',\n      dataIndex: 'gender',\n      width: '6%'\n    }, {\n      title: 'Type',\n      dataIndex: 'type',\n      width: '6%'\n    }, {\n      title: 'Birth',\n      dataIndex: 'birth',\n      width: '20%'\n    }, {\n      title: 'Email',\n      dataIndex: 'Email',\n      width: '20%'\n    }, {\n      title: 'Edit',\n      dataIndex: 'Edit',\n      width: '10%'\n    }, {\n      title: 'Delete',\n      dataIndex: 'delete',\n      width: '10%'\n    }];\n    const __returned__ = {\n      router,\n      dataSource,\n      pagination,\n      fetchData,\n      edit,\n      deleteRecord,\n      columns,\n      onMounted,\n      ref,\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","useRouter","router","dataSource","pagination","currentPage","pageSize","totalItems","totalPages","fetchData","value","response","fetch","ok","Error","status","data","json","students","error","console","edit","key","push","deleteRecord","method","log","columns","title","dataIndex","width"],"sources":["C:/Users/bobxi/OneDrive/Desktop/Ecloud/tut8/my-vue-app/src/components/AdminList.vue"],"sourcesContent":["<template>\r\n    <a-table :columns=\"columns\" :data-source=\"dataSource\" bordered>\r\n    <template #bodyCell=\"{ record, column }\">\r\n      <div v-if=\"column.dataIndex === 'action'\">\r\n        <a-button type=\"primary\" @click=\"edit(record.key)\">Edit</a-button>\r\n        <a-button type=\"danger\" @click=\"deleteRecord(record.key)\">Delete</a-button>\r\n      </div>\r\n      <div v-else>{{ record[column.dataIndex] }}</div>\r\n    </template>\r\n  </a-table>\r\n  </template>\r\n  <script setup>\r\n\r\n  import { onMounted, ref } from 'vue';\r\n  import { useRouter } from 'vue-router';\r\n\r\nconst router = useRouter();\r\n\r\nconst dataSource = ref([]);\r\nconst pagination = ref({ currentPage: 1, pageSize: 2, totalItems: 0, totalPages: 0 });\r\n\r\nconst fetchData = async () => {\r\n  try {\r\n    const pageSize = pagination.value.pageSize;\r\n    const currentPage = pagination.value.currentPage;\r\n    const response = await fetch(`http://localhost:8000/admins?page=${currentPage}&pageSize=${pageSize}`);\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status}`);\r\n    }\r\n    const data = await response.json();\r\n    dataSource.value = data.students; // 假设后端返回的数据字段为 students\r\n    // 更新分页信息\r\n    pagination.value.totalPages = data.totalPages;\r\n    pagination.value.totalItems = data.totalItems;\r\n  } catch (error) {\r\n    console.error(\"Fetching error:\", error);\r\n  }\r\n};\r\n\r\nonMounted(() => {\r\n  fetchData();\r\n});\r\nconst edit = (key) => {\r\n  router.push(`/edit/${key}`);\r\n};\r\n\r\nconst deleteRecord = async (key) => {\r\n  try {\r\n    await fetch(`http://localhost:3001/delete/${key}`, {\r\n      method: 'DELETE',\r\n    });\r\n    console.log('Record deleted successfully');\r\n  } catch (error) {\r\n    console.error('Failed to delete the record:', error);\r\n  }\r\n};\r\n\r\n  const columns = [\r\n    {\r\n      title: 'Name',\r\n      dataIndex: 'name',\r\n      width: '8%',\r\n    },\r\n    {\r\n      title: 'Age',\r\n      dataIndex: 'age',\r\n      width: '5%',\r\n    },\r\n    {\r\n      title: 'Gender',\r\n      dataIndex: 'gender',\r\n      width: '6%',\r\n    },\r\n    {\r\n      title: 'Type',\r\n      dataIndex: 'type',\r\n      width: '6%',\r\n    },\r\n    {\r\n      title: 'Birth',\r\n      dataIndex: 'birth',\r\n      width: '20%',\r\n    },\r\n    {\r\n      title: 'Email',\r\n      dataIndex: 'Email',\r\n      width: '20%',\r\n    },\r\n    {\r\n      title: 'Edit',\r\n      dataIndex: 'Edit',\r\n      width: '10%',\r\n    },\r\n    {\r\n      title: 'Delete',\r\n      dataIndex: 'delete',\r\n      width: '10%',\r\n    },\r\n  ];\r\n\r\n  \r\n </script>"],"mappings":";AAaE,SAASA,SAAS,EAAEC,GAAG,QAAQ,KAAK;AACpC,SAASC,SAAS,QAAQ,YAAY;;;;;;;IAExC,MAAMC,MAAM,GAAGD,SAAS,CAAC,CAAC;IAE1B,MAAME,UAAU,GAAGH,GAAG,CAAC,EAAE,CAAC;IAC1B,MAAMI,UAAU,GAAGJ,GAAG,CAAC;MAAEK,WAAW,EAAE,CAAC;MAAEC,QAAQ,EAAE,CAAC;MAAEC,UAAU,EAAE,CAAC;MAAEC,UAAU,EAAE;IAAE,CAAC,CAAC;IAErF,MAAMC,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC5B,IAAI;QACF,MAAMH,QAAQ,GAAGF,UAAU,CAACM,KAAK,CAACJ,QAAQ;QAC1C,MAAMD,WAAW,GAAGD,UAAU,CAACM,KAAK,CAACL,WAAW;QAChD,MAAMM,QAAQ,GAAG,MAAMC,KAAK,CAAE,qCAAoCP,WAAY,aAAYC,QAAS,EAAC,CAAC;QACrG,IAAI,CAACK,QAAQ,CAACE,EAAE,EAAE;UAChB,MAAM,IAAIC,KAAK,CAAE,uBAAsBH,QAAQ,CAACI,MAAO,EAAC,CAAC;QAC3D;QACA,MAAMC,IAAI,GAAG,MAAML,QAAQ,CAACM,IAAI,CAAC,CAAC;QAClCd,UAAU,CAACO,KAAK,GAAGM,IAAI,CAACE,QAAQ,CAAC,CAAC;QAClC;QACAd,UAAU,CAACM,KAAK,CAACF,UAAU,GAAGQ,IAAI,CAACR,UAAU;QAC7CJ,UAAU,CAACM,KAAK,CAACH,UAAU,GAAGS,IAAI,CAACT,UAAU;MAC/C,CAAC,CAAC,OAAOY,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,iBAAiB,EAAEA,KAAK,CAAC;MACzC;IACF,CAAC;IAEDpB,SAAS,CAAC,MAAM;MACdU,SAAS,CAAC,CAAC;IACb,CAAC,CAAC;IACF,MAAMY,IAAI,GAAIC,GAAG,IAAK;MACpBpB,MAAM,CAACqB,IAAI,CAAE,SAAQD,GAAI,EAAC,CAAC;IAC7B,CAAC;IAED,MAAME,YAAY,GAAG,MAAOF,GAAG,IAAK;MAClC,IAAI;QACF,MAAMV,KAAK,CAAE,gCAA+BU,GAAI,EAAC,EAAE;UACjDG,MAAM,EAAE;QACV,CAAC,CAAC;QACFL,OAAO,CAACM,GAAG,CAAC,6BAA6B,CAAC;MAC5C,CAAC,CAAC,OAAOP,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;MACtD;IACF,CAAC;IAEC,MAAMQ,OAAO,GAAG,CACd;MACEC,KAAK,EAAE,MAAM;MACbC,SAAS,EAAE,MAAM;MACjBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,KAAK;MACZC,SAAS,EAAE,KAAK;MAChBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,QAAQ;MACfC,SAAS,EAAE,QAAQ;MACnBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,MAAM;MACbC,SAAS,EAAE,MAAM;MACjBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,OAAO;MACdC,SAAS,EAAE,OAAO;MAClBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,OAAO;MACdC,SAAS,EAAE,OAAO;MAClBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,MAAM;MACbC,SAAS,EAAE,MAAM;MACjBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,QAAQ;MACfC,SAAS,EAAE,QAAQ;MACnBC,KAAK,EAAE;IACT,CAAC,CACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}