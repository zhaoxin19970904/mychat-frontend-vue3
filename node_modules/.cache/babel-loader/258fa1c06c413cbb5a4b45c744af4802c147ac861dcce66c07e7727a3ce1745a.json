{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { onMounted, ref } from 'vue';\nimport { useRouter } from 'vue-router';\nexport default {\n  __name: 'AdminList',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const dataSource = ref([]);\n    const pagination = ref({\n      current: 1,\n      pageSize: 2,\n      showSizeChanger: true,\n      pageSizeOptions: ['2', '5', '10']\n    });\n    const fetchData = async () => {\n      try {\n        const pageSize = pagination.value.pageSize;\n        const currentPage = pagination.value.current;\n        const response = await fetch(`http://localhost:8000/users/admins?page=${currentPage}&pageSize=${pageSize}`);\n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const data = await response.json();\n        dataSource.value = data.students;\n        console.log(data);\n        pagination.value.totalPages = data.totalPages;\n        pagination.value.total = data.totalItems;\n      } catch (error) {\n        console.error(\"Fetching error:\", error);\n      }\n    };\n    onMounted(() => {\n      fetchData();\n    });\n    const edit = key => {\n      console.log(key);\n      router.push(`/edit/${key}`);\n    };\n    const deleteRecord = async key => {\n      try {\n        await fetch(`http://localhost:3001/delete/${key}`, {\n          method: 'DELETE'\n        });\n        console.log('Record deleted successfully');\n      } catch (error) {\n        console.error('Failed to delete the record:', error);\n      }\n    };\n    const handleTableChange = newPagination => {\n      pagination.value.current = newPagination.current;\n      pagination.value.pageSize = newPagination.pageSize;\n      fetchData(newPagination);\n    };\n    const columns = [{\n      title: 'Name',\n      dataIndex: 'username',\n      width: '8%'\n    }, {\n      title: 'Age',\n      dataIndex: 'age',\n      width: '5%'\n    }, {\n      title: 'Gender',\n      dataIndex: 'gender',\n      width: '6%'\n    }, {\n      title: 'Type',\n      dataIndex: 'type',\n      width: '6%'\n    }, {\n      title: 'Birth',\n      dataIndex: 'birth',\n      width: '20%'\n    }, {\n      title: 'Email',\n      dataIndex: 'email',\n      width: '20%'\n    }, {\n      title: 'Edit',\n      dataIndex: 'edit',\n      width: '10%'\n    }, {\n      title: 'Delete',\n      dataIndex: 'delete',\n      width: '10%'\n    }];\n    const __returned__ = {\n      router,\n      dataSource,\n      pagination,\n      fetchData,\n      edit,\n      deleteRecord,\n      handleTableChange,\n      columns,\n      onMounted,\n      ref,\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","useRouter","router","dataSource","pagination","current","pageSize","showSizeChanger","pageSizeOptions","fetchData","value","currentPage","response","fetch","ok","Error","status","data","json","students","console","log","totalPages","total","totalItems","error","edit","key","push","deleteRecord","method","handleTableChange","newPagination","columns","title","dataIndex","width"],"sources":["C:/Users/bobxi/OneDrive/Desktop/Ecloud/tut8/my-vue-app/src/components/AdminList.vue"],"sourcesContent":["<template>\r\n    <a-table :columns=\"columns\" \r\n    :data-source=\"dataSource\" \r\n    :pagination=\"pagination\"\r\n    @change=\"handleTableChange\"\r\n\r\n    bordered>\r\n    <template #bodyCell=\"{ record, column }\">\r\n        <div v-if=\"column.dataIndex === 'edit'\">\r\n      <a-button type=\"primary\" @click=\"edit(record.id)\">Edit</a-button>\r\n    </div>\r\n    <div v-else-if=\"column.dataIndex === 'delete'\">\r\n      <a-button type=\"primary\" @click=\"deleteRecord(record.id)\">Delete</a-button>\r\n    </div>\r\n    <div v-else>\r\n      {{ record[column.dataIndex] }}\r\n    </div>\r\n    </template>\r\n  </a-table>\r\n  </template>\r\n  <script setup>\r\n\r\n  import { onMounted, ref } from 'vue';\r\n  import { useRouter } from 'vue-router';\r\n\r\nconst router = useRouter();\r\n\r\nconst dataSource = ref([]);\r\nconst pagination = ref({ current: 1, pageSize: 2,showSizeChanger: true, pageSizeOptions: ['2', '5', '10']});\r\n\r\n\r\nconst fetchData = async () => {\r\n  try {\r\n    const pageSize = pagination.value.pageSize;\r\n    const currentPage = pagination.value.current;\r\n    const response = await fetch(`http://localhost:8000/users/admins?page=${currentPage}&pageSize=${pageSize}`);\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status}`);\r\n    }\r\n    const data = await response.json();\r\n    dataSource.value = data.students; \r\n    console.log(data)\r\n    pagination.value.totalPages = data.totalPages;\r\n    pagination.value.total = data.totalItems;\r\n  } catch (error) {\r\n    console.error(\"Fetching error:\", error);\r\n  }\r\n};\r\n\r\nonMounted(() => {\r\n  fetchData();\r\n});\r\nconst edit = (key) => {\r\n    console.log(key)\r\n  router.push(`/edit/${key}`);\r\n};\r\n\r\nconst deleteRecord = async (key) => {\r\n  try {\r\n    await fetch(`http://localhost:3001/delete/${key}`, {\r\n      method: 'DELETE',\r\n    });\r\n    console.log('Record deleted successfully');\r\n  } catch (error) {\r\n    console.error('Failed to delete the record:', error);\r\n  }\r\n};\r\n\r\nconst handleTableChange = (newPagination) => {\r\n        pagination.value.current=newPagination.current;\r\n        pagination.value.pageSize=newPagination.pageSize\r\n        fetchData(newPagination);\r\n      };\r\n\r\n  const columns = [\r\n    {\r\n      title: 'Name',\r\n      dataIndex: 'username',\r\n      width: '8%',\r\n    },\r\n    {\r\n      title: 'Age',\r\n      dataIndex: 'age',\r\n      width: '5%',\r\n    },\r\n    {\r\n      title: 'Gender',\r\n      dataIndex: 'gender',\r\n      width: '6%',\r\n    },\r\n    {\r\n      title: 'Type',\r\n      dataIndex: 'type',\r\n      width: '6%',\r\n    },\r\n    {\r\n      title: 'Birth',\r\n      dataIndex: 'birth',\r\n      width: '20%',\r\n    },\r\n    {\r\n      title: 'Email',\r\n      dataIndex: 'email',\r\n      width: '20%',\r\n    },\r\n    {\r\n      title: 'Edit',\r\n      dataIndex: 'edit',\r\n      width: '10%',\r\n\r\n    },\r\n    {\r\n      title: 'Delete',\r\n      dataIndex: 'delete',\r\n      width: '10%',\r\n    },\r\n  ];\r\n  \r\n\r\n  \r\n </script>"],"mappings":";AAsBE,SAASA,SAAS,EAAEC,GAAG,QAAQ,KAAK;AACpC,SAASC,SAAS,QAAQ,YAAY;;;;;;;IAExC,MAAMC,MAAM,GAAGD,SAAS,CAAC,CAAC;IAE1B,MAAME,UAAU,GAAGH,GAAG,CAAC,EAAE,CAAC;IAC1B,MAAMI,UAAU,GAAGJ,GAAG,CAAC;MAAEK,OAAO,EAAE,CAAC;MAAEC,QAAQ,EAAE,CAAC;MAACC,eAAe,EAAE,IAAI;MAAEC,eAAe,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI;IAAC,CAAC,CAAC;IAG3G,MAAMC,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC5B,IAAI;QACF,MAAMH,QAAQ,GAAGF,UAAU,CAACM,KAAK,CAACJ,QAAQ;QAC1C,MAAMK,WAAW,GAAGP,UAAU,CAACM,KAAK,CAACL,OAAO;QAC5C,MAAMO,QAAQ,GAAG,MAAMC,KAAK,CAAE,2CAA0CF,WAAY,aAAYL,QAAS,EAAC,CAAC;QAC3G,IAAI,CAACM,QAAQ,CAACE,EAAE,EAAE;UAChB,MAAM,IAAIC,KAAK,CAAE,uBAAsBH,QAAQ,CAACI,MAAO,EAAC,CAAC;QAC3D;QACA,MAAMC,IAAI,GAAG,MAAML,QAAQ,CAACM,IAAI,CAAC,CAAC;QAClCf,UAAU,CAACO,KAAK,GAAGO,IAAI,CAACE,QAAQ;QAChCC,OAAO,CAACC,GAAG,CAACJ,IAAI,CAAC;QACjBb,UAAU,CAACM,KAAK,CAACY,UAAU,GAAGL,IAAI,CAACK,UAAU;QAC7ClB,UAAU,CAACM,KAAK,CAACa,KAAK,GAAGN,IAAI,CAACO,UAAU;MAC1C,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdL,OAAO,CAACK,KAAK,CAAC,iBAAiB,EAAEA,KAAK,CAAC;MACzC;IACF,CAAC;IAED1B,SAAS,CAAC,MAAM;MACdU,SAAS,CAAC,CAAC;IACb,CAAC,CAAC;IACF,MAAMiB,IAAI,GAAIC,GAAG,IAAK;MAClBP,OAAO,CAACC,GAAG,CAACM,GAAG,CAAC;MAClBzB,MAAM,CAAC0B,IAAI,CAAE,SAAQD,GAAI,EAAC,CAAC;IAC7B,CAAC;IAED,MAAME,YAAY,GAAG,MAAOF,GAAG,IAAK;MAClC,IAAI;QACF,MAAMd,KAAK,CAAE,gCAA+Bc,GAAI,EAAC,EAAE;UACjDG,MAAM,EAAE;QACV,CAAC,CAAC;QACFV,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC;MAC5C,CAAC,CAAC,OAAOI,KAAK,EAAE;QACdL,OAAO,CAACK,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;MACtD;IACF,CAAC;IAED,MAAMM,iBAAiB,GAAIC,aAAa,IAAK;MACrC5B,UAAU,CAACM,KAAK,CAACL,OAAO,GAAC2B,aAAa,CAAC3B,OAAO;MAC9CD,UAAU,CAACM,KAAK,CAACJ,QAAQ,GAAC0B,aAAa,CAAC1B,QAAQ;MAChDG,SAAS,CAACuB,aAAa,CAAC;IAC1B,CAAC;IAEL,MAAMC,OAAO,GAAG,CACd;MACEC,KAAK,EAAE,MAAM;MACbC,SAAS,EAAE,UAAU;MACrBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,KAAK;MACZC,SAAS,EAAE,KAAK;MAChBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,QAAQ;MACfC,SAAS,EAAE,QAAQ;MACnBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,MAAM;MACbC,SAAS,EAAE,MAAM;MACjBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,OAAO;MACdC,SAAS,EAAE,OAAO;MAClBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,OAAO;MACdC,SAAS,EAAE,OAAO;MAClBC,KAAK,EAAE;IACT,CAAC,EACD;MACEF,KAAK,EAAE,MAAM;MACbC,SAAS,EAAE,MAAM;MACjBC,KAAK,EAAE;IAET,CAAC,EACD;MACEF,KAAK,EAAE,QAAQ;MACfC,SAAS,EAAE,QAAQ;MACnBC,KAAK,EAAE;IACT,CAAC,CACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}